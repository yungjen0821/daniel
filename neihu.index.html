<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>內湖文德開發案 - 投資評估與執行計畫報告書</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; }
        .chart-container { position: relative; height: 100%; width: 100%; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- 通用圖表組件 (使用 Chart.js) ---
        const ChartComponent = ({ type, data, options }) => {
            const chartRef = React.useRef(null);
            const canvasRef = React.useRef(null);

            React.useEffect(() => {
                if (canvasRef.current) {
                    // 銷毀舊圖表以避免重疊
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }

                    const ctx = canvasRef.current.getContext('2d');
                    chartRef.current = new Chart(ctx, {
                        type: type,
                        data: data,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            ...options
                        }
                    });
                }
                return () => {
                    if (chartRef.current) {
                        chartRef.current.destroy();
                    }
                };
            }, [type, data, options]);

            return (
                <div className="chart-container">
                    <canvas ref={canvasRef}></canvas>
                </div>
            );
        };

        // Lucide Icons Wrapper Component
        const Icon = ({ name, className }) => {
            React.useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        // --- 數據資料 ---

        const cashFlowData = [
            { year: '2026', amount: 3850, label: '3,850萬', note: '整合/設計/請照' },
            { year: '2027', amount: 3450, label: '3,450萬', note: '發包/開工/假設' },
            { year: '2028', amount: 19150, label: '1.91億', note: '地下結構(高峰)' },
            { year: '2029', amount: 23450, label: '2.34億', note: '地上結構(最高)' },
            { year: '2030', amount: 16450, label: '1.64億', note: '裝修/完工/交屋' },
            { year: '2031', amount: 650, label: '650萬', note: '結案保固' },
        ];

        const detailedTimeline = [
            { date: '2026/01', task: '專案啟動', desc: '簽訂專案合約與畸零地整合', type: 'plan' },
            { date: '2026/03', task: '建照申請', desc: '準備審查文件、都市審議', type: 'plan' },
            { date: '2026/12', task: '建照核准', desc: '取得建築執照 (預計 12/2)', type: 'milestone' },
            { date: '2027/06', task: '申報開工', desc: '營造廠簽約、申報開工', type: 'milestone' },
            { date: '2027/12', task: '基礎工程', desc: '連續壁、導溝施工開始', type: 'construct' },
            { date: '2028/05', task: '地下結構', desc: '地下室開挖與支撐施作', type: 'construct' },
            { date: '2028/11', task: '地上結構', desc: '開始地上層結構體 (2F灌漿)', type: 'construct' },
            { date: '2029/07', task: '結構封頂', desc: '屋頂版 (R1F) 灌漿完成', type: 'milestone' },
            { date: '2029/07', task: '外牆工程', desc: '打石、鋁窗安裝、防水施作', type: 'construct' },
            { date: '2029/12', task: '內裝機電', desc: '室內裝修與機電設備安裝', type: 'construct' },
            { date: '2030/07', task: '使照取得', desc: '預計 7/30 取得使用執照', type: 'milestone' },
            { date: '2030/08', task: '交屋完成', desc: '產權登記與交屋', type: 'finish' },
        ];

        const rentalRampUpData = [
            { period: '2030 Q3', occupancy: 30, revenue: 1192, note: '交屋/初期進駐' },
            { period: '2030 Q4', occupancy: 50, revenue: 1987, note: '正式營運' },
            { period: '2031 Q1', occupancy: 70, revenue: 2782, note: '成長期' },
            { period: '2031 Q2', occupancy: 85, revenue: 3378, note: '穩定期' },
            { period: '2031 Q3', occupancy: 95, revenue: 3776, note: '滿租目標' },
        ];

        // 長期金流 (單位：萬元)
        const longTermCashFlowData = [
            { year: 2026, income: 0, expense: 3850, net: -3850, cumulative: -3850, note: '投入' },
            { year: 2027, income: 0, expense: 3450, net: -3450, cumulative: -7300, note: '投入' },
            { year: 2028, income: 0, expense: 19150, net: -19150, cumulative: -26450, note: '高峰' },
            { year: 2029, income: 0, expense: 23450, net: -23450, cumulative: -49900, note: '高峰' },
            { year: 2030, income: 3180, expense: 18290, net: -15110, cumulative: -65010, note: '完工' }, 
            { year: 2031, income: 13720, expense: 5440, net: 8280, cumulative: -56730, note: '爬坡' },
            { year: 2032, income: 15120, expense: 5000, net: 10120, cumulative: -46610, note: '穩收' },
            { year: 2033, income: 15120, expense: 5000, net: 10120, cumulative: -36490, note: '穩收' },
            { year: 2034, income: 15120, expense: 5000, net: 10120, cumulative: -26370, note: '穩收' },
            { year: 2035, income: 15120, expense: 5000, net: 10120, cumulative: -16250, note: '穩收' },
            { year: 2036, income: 15120, expense: 5000, net: 10120, cumulative: -6130, note: '穩收' },
            { year: 2037, income: 15120, expense: 5000, net: 10120, cumulative: 3990, note: '回正' },
        ];

        // 情境二 - 額外資金需求表 (單位：億元)
        const constructionInflationData = [
            { scenario: '原始預算', totalEquity: 2.85, addedEquity: 0, totalCost: 6.70, fill: '#3b82f6' },
            { scenario: '營造漲 10%', totalEquity: 3.40, addedEquity: 0.55, totalCost: 7.25, fill: '#f59e0b' },
            { scenario: '營造漲 15%', totalEquity: 3.68, addedEquity: 0.83, totalCost: 7.53, fill: '#f97316' },
            { scenario: '營造漲 20%', totalEquity: 3.95, addedEquity: 1.10, totalCost: 7.80, fill: '#ef4444' },
        ];

        const assumptions = [
            { category: '開發成本', item: '總預算', value: '6.7 億元', note: '含營造5.5億、管理、設計、畸零地' },
            { category: '銀行融資', item: '貸款金額', value: '3.85 億元', note: '約佔總開發成本 57% (或營造費 70%)' },
            { category: '自有資金', item: '基礎自備款', value: '2.85 億元', note: '需隨工程進度支付' },
            { category: '租金收益', item: '年總收入', value: '4,770 萬元', note: '滿租：2500坪x1500元 + 50車位' },
            { category: '財務利率', item: '融資利率', value: '3.7%', note: '依目前市場水準設定' },
        ];

        // --- 組件 ---

        const SectionTitle = ({ icon, title }) => (
            <div className="flex items-center border-b-2 border-slate-800 pb-2 mb-4 mt-8">
                <Icon name={icon} className="w-6 h-6 mr-2 text-slate-800" />
                <h2 className="text-xl font-bold text-slate-900">{title}</h2>
            </div>
        );

        const DataBox = ({ label, value, subtext, highlight = false, alert = false }) => (
            <div className={`p-4 rounded border ${alert ? 'bg-red-50 border-red-200' : highlight ? 'bg-blue-50 border-blue-200' : 'bg-white border-slate-200'}`}>
                <p className={`text-xs uppercase tracking-wide ${alert ? 'text-red-600' : 'text-slate-500'}`}>{label}</p>
                <p className={`text-2xl font-bold mt-1 ${alert ? 'text-red-700' : highlight ? 'text-blue-700' : 'text-slate-800'}`}>{value}</p>
                {subtext && <p className="text-xs text-slate-500 mt-1">{subtext}</p>}
            </div>
        );

        // --- Chart Configurations ---

        // Chart 1: Cash Flow Outflow (Annual)
        const chartCashFlowConfig = {
            type: 'bar',
            data: {
                labels: cashFlowData.map(d => d.year),
                datasets: [{
                    label: '年度總支出 (萬元)',
                    data: cashFlowData.map(d => d.amount),
                    backgroundColor: cashFlowData.map(d => d.amount > 20000 ? '#ef4444' : '#3b82f6'),
                    borderRadius: 4
                }]
            },
            options: {
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (ctx) => ` 支出: ${new Intl.NumberFormat('zh-TW').format(ctx.raw)} 萬元`
                        }
                    }
                },
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: '金額 (萬元)' } }
                }
            }
        };

        // Chart 2: Revenue Ramp Up (Combo)
        const chartRevenueConfig = {
            type: 'bar',
            data: {
                labels: rentalRampUpData.map(d => d.period),
                datasets: [
                    {
                        label: '預估季收入 (萬元)',
                        data: rentalRampUpData.map(d => d.revenue),
                        backgroundColor: '#10b981',
                        order: 2,
                        yAxisID: 'y'
                    },
                    {
                        label: '出租率 (%)',
                        data: rentalRampUpData.map(d => d.occupancy),
                        borderColor: '#f59e0b',
                        backgroundColor: '#f59e0b',
                        type: 'line',
                        order: 1,
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: (ctx) => {
                                if (ctx.dataset.type === 'line') return ` 出租率: ${ctx.raw}%`;
                                return ` 收入: ${new Intl.NumberFormat('zh-TW').format(ctx.raw)} 萬元`;
                            }
                        }
                    }
                },
                scales: {
                    y: { type: 'linear', display: true, position: 'left', title: { display: true, text: '收入 (萬元)' } },
                    y1: { type: 'linear', display: true, position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: '出租率 (%)' }, max: 100 }
                }
            }
        };

        // Chart 3: Scenario (Horizontal Bar)
        const chartScenarioConfig = {
            type: 'bar',
            data: {
                labels: constructionInflationData.map(d => d.scenario),
                datasets: [{
                    label: '總自備款需求 (億元)',
                    data: constructionInflationData.map(d => d.totalEquity),
                    backgroundColor: constructionInflationData.map(d => d.fill),
                    borderRadius: 4
                }]
            },
            options: {
                indexAxis: 'y',
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (ctx) => {
                                const item = constructionInflationData[ctx.dataIndex];
                                return [` 總自備款: ${ctx.raw} 億`, ` 需額外準備: ${item.addedEquity} 億`];
                            }
                        }
                    }
                },
                scales: {
                    x: { beginAtZero: false, min: 2, title: { display: true, text: '金額 (億元)' } }
                }
            }
        };

        // Chart 4: Long Term (Combo: Net Flow + Cumulative)
        const chartLongTermConfig = {
            type: 'bar',
            data: {
                labels: longTermCashFlowData.map(d => d.year),
                datasets: [
                    {
                        label: '年度淨現金流',
                        data: longTermCashFlowData.map(d => d.net),
                        backgroundColor: longTermCashFlowData.map(d => d.net >= 0 ? '#10b981' : '#3b82f6'),
                        order: 2,
                        yAxisID: 'y'
                    },
                    {
                        label: '累計資金缺口',
                        data: longTermCashFlowData.map(d => d.cumulative),
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        type: 'line',
                        fill: true,
                        order: 1,
                        yAxisID: 'y1',
                        pointRadius: 2
                    }
                ]
            },
            options: {
                responsive: true,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: (ctx) => {
                                return ` ${ctx.dataset.label}: ${new Intl.NumberFormat('zh-TW').format(ctx.raw)} 萬元`;
                            }
                        }
                    }
                },
                scales: {
                    y: { type: 'linear', display: true, position: 'left', title: { display: true, text: '年度淨流 (萬元)' } },
                    y1: { type: 'linear', display: true, position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: '累計結餘 (萬元)' } }
                }
            }
        };


        const App = () => {
            return (
                <div className="max-w-[210mm] mx-auto bg-white shadow-xl min-h-[297mm] p-[15mm] md:p-[20mm] text-slate-800 my-8">
                    
                    {/* Header */}
                    <header className="border-b-4 border-slate-900 pb-6 mb-8 flex justify-between items-end">
                        <div>
                            <h1 className="text-3xl font-extrabold text-slate-900 mb-2">內湖文德段商辦開發案</h1>
                            <p className="text-slate-600 font-sans font-medium">投資評估與執行計畫報告書 v10.0 (Final)</p>
                        </div>
                        <div className="text-right text-sm text-slate-500">
                            <p>報告日期：2025年12月</p>
                            <p>機密等級：內部與合作夥伴</p>
                        </div>
                    </header>

                    {/* 1. Executive Summary */}
                    <section className="mb-8">
                        <h3 className="text-lg font-bold mb-3 bg-slate-100 p-2 border-l-4 border-slate-800">專案執行摘要 (Executive Summary)</h3>
                        <p className="text-sm leading-relaxed text-slate-700 mb-4 text-justify">
                            本案總開發預算為 <strong>6.7 億元</strong>。銀行融資約 3.85 億元，基礎自備款需求為 2.85 億元。
                            <span className="bg-yellow-100 px-1 rounded">特別提醒：雖然 2026 年帳面支出為 3,850 萬元，但考量 2027 年初的營造預付款與融資撥款時差，建議於 2026 年底前備妥 <strong>6,000 萬元</strong> 流動現金以確保周轉。</span>
                            專案預計於 2030 年 Q3 完工，並於 2037 年達成總體資金回本。
                        </p>
                        
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-2 font-sans">
                            <DataBox label="專案總預算" value="6.7 億" subtext="不含土地成本" />
                            <DataBox label="2026 建議現金" value="6,000 萬" subtext="含3850萬支出+周轉金" highlight={true} />
                            <DataBox label="預計回本年" value="2037 年" subtext="營運第 7 年" highlight={true} />
                            <DataBox label="額外現金風險" value="+1.1 億" subtext="若造價漲 20%" alert={true} />
                        </div>
                    </section>

                    {/* 2. Scenario Analysis */}
                    <section className="mb-8 bg-red-50/30 p-6 rounded-xl border border-red-100">
                        <SectionTitle icon="shield-alert" title="財務壓力測試與情境模擬 (Stress Test)" />
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            {/* Scenario 1 */}
                            <div>
                                <h4 className="font-bold text-red-900 mb-3 text-sm flex items-center">
                                    <Icon name="trending-down" className="w-4 h-4 mr-2" /> 情境一：交屋後 3 年出租率 0%
                                </h4>
                                <div className="bg-white p-4 rounded shadow-sm border border-red-100 mb-3">
                                    <div className="flex justify-between items-end border-b border-slate-100 pb-2 mb-2">
                                        <span className="text-sm text-slate-600">銀行貸款本利攤還</span>
                                        <span className="font-bold text-slate-800">2,727 萬/年</span>
                                    </div>
                                    <div className="flex justify-between items-end border-b border-slate-100 pb-2 mb-2">
                                        <span className="text-sm text-slate-600">基本持有成本 (稅/維護)</span>
                                        <span className="font-bold text-slate-800">500 萬/年</span>
                                    </div>
                                    <div className="flex justify-between items-end pt-1">
                                        <span className="font-bold text-red-700">單一年度現金流出</span>
                                        <span className="font-bold text-red-700 text-lg">-3,227 萬元</span>
                                    </div>
                                </div>
                            </div>

                            {/* Scenario 2 */}
                            <div>
                                <h4 className="font-bold text-orange-800 mb-3 text-sm flex items-center">
                                    <Icon name="trending-up" className="w-4 h-4 mr-2" /> 情境二：營造費用上漲之「額外現金需求」
                                </h4>
                                <div className="h-40 w-full mb-2 bg-white p-2 rounded border border-orange-100">
                                    <ChartComponent type="bar" data={chartScenarioConfig.data} options={chartScenarioConfig.options} />
                                </div>
                                
                                {/* Added Funds Table */}
                                <div className="mt-2 bg-white rounded border border-orange-200 overflow-hidden text-xs">
                                    <table className="w-full text-left">
                                        <thead className="bg-orange-100 text-orange-900">
                                            <tr>
                                                <th className="p-2">漲幅情境</th>
                                                <th className="p-2 text-right">總成本</th>
                                                <th className="p-2 text-right text-red-600 font-bold">需額外準備現金</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {constructionInflationData.slice(1).map((row, idx) => (
                                                <tr key={idx} className="border-t border-orange-50">
                                                    <td className="p-2">{row.scenario}</td>
                                                    <td className="p-2 text-right">{row.totalCost} 億</td>
                                                    <td className="p-2 text-right font-bold text-red-600">+{row.addedEquity} 億</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* 3. Detailed Timeline */}
                    <section className="mb-8">
                        <SectionTitle icon="clock" title="詳細工程時間軸" />
                        <div className="relative border-l-2 border-slate-200 ml-3 space-y-4 font-sans">
                            {detailedTimeline.map((item, index) => (
                                <div key={index} className="ml-6 relative">
                                    <div className={`absolute -left-[31px] top-1 w-4 h-4 rounded-full border-2 border-white shadow-sm 
                                        ${item.type === 'milestone' ? 'bg-red-500 w-5 h-5 -left-[33px]' : 
                                            item.type === 'construct' ? 'bg-blue-500' : 
                                            item.type === 'finish' ? 'bg-green-500' : 'bg-slate-400'}`}>
                                    </div>
                                    <div className="flex flex-col md:flex-row md:items-center">
                                        <span className="text-sm font-bold text-slate-500 w-20">{item.date}</span>
                                        <div className={`flex-1 p-2 rounded border ${item.type === 'milestone' ? 'bg-red-50 border-red-100' : 'bg-white border-slate-200'}`}>
                                            <h4 className={`text-sm font-bold ${item.type === 'milestone' ? 'text-red-800' : 'text-slate-800'}`}>
                                                {item.task}
                                            </h4>
                                            <p className="text-xs text-slate-600">{item.desc}</p>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </section>

                    {/* 4. Rental Revenue Projection */}
                    <section className="mb-8">
                        <SectionTitle icon="users" title="預租與營運租金收入預估" />
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-green-50/50 p-4 rounded-xl border border-green-100">
                            <div className="h-56 w-full bg-white p-2 rounded shadow-sm border border-slate-100">
                                <ChartComponent type="bar" data={chartRevenueConfig.data} options={chartRevenueConfig.options} />
                            </div>
                            <div className="font-sans text-sm space-y-2">
                                <h4 className="font-bold text-slate-800">營收爬坡摘要</h4>
                                <p className="text-xs text-slate-600">
                                    目標於 2031 年 Q3 達到 95% 滿租。
                                    屆時單季營收可達 <strong>3,776 萬元</strong>。
                                </p>
                                <table className="w-full text-left border-collapse bg-white shadow-sm rounded overflow-hidden text-xs">
                                    <thead className="bg-green-100 text-green-900">
                                        <tr>
                                            <th className="p-2">期間</th>
                                            <th className="p-2 text-right">出租率</th>
                                            <th className="p-2 text-right">季收入(萬)</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-green-50">
                                        {rentalRampUpData.map((row, idx) => (
                                            <tr key={idx}>
                                                <td className="p-2 text-slate-600">{row.period}</td>
                                                <td className="p-2 text-right font-bold text-amber-600">{row.occupancy}%</td>
                                                <td className="p-2 text-right font-bold text-green-700">{new Intl.NumberFormat('zh-TW').format(row.revenue)}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    {/* 5. Financial Structure */}
                    <section className="mb-8">
                        <SectionTitle icon="dollar-sign" title="年度資金支出與平衡" />
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div className="h-48 border border-slate-100 rounded bg-slate-50 p-2">
                                <ChartComponent type="bar" data={chartCashFlowConfig.data} options={chartCashFlowConfig.options} />
                            </div>
                            <div className="bg-slate-50 border border-slate-200 p-4 rounded text-sm space-y-2">
                                <h4 className="font-bold text-slate-800">2026 資金特別說明</h4>
                                <div className="bg-blue-50 p-2 rounded text-xs text-blue-800 mb-2">
                                    <Icon name="info" className="w-3 h-3 inline mr-1" />
                                    <strong>為什麼支出 3,850 萬卻要準備 6,000 萬？</strong><br/>
                                    答：2026 年僅支付設計與整合費。但銀行建融通常於 2027 年中（開工後）才撥款，故需預留 2,000 多萬支付 2027 上半年的營造訂金與周轉。
                                </div>
                                <div className="flex justify-between border-t border-slate-300 pt-2 mt-2">
                                    <span className="font-bold text-slate-800">年度淨現金流 (滿租)</span>
                                    <span className="font-bold text-blue-600">+1,012 萬</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* 6. Feasibility Assessment */}
                    <section className="mb-8 border-t-2 border-slate-800 pt-8">
                        <div className="flex items-center justify-center mb-6">
                            <h2 className="text-2xl font-extrabold text-slate-900 bg-slate-900 text-white px-6 py-2 rounded-full shadow-lg">專案可行性綜合評估 (Final Verdict)</h2>
                        </div>

                        <div className="mb-8">
                            <h4 className="font-bold text-slate-700 mb-3 text-sm flex items-center">
                                <Icon name="sliders" className="w-4 h-4 mr-2" /> 評估基礎參數表 (Key Assumptions)
                            </h4>
                            <div className="overflow-hidden border border-slate-200 rounded-lg shadow-sm">
                                <table className="w-full text-sm text-left">
                                    <thead className="bg-slate-100 text-slate-700 font-bold">
                                        <tr>
                                            <th className="p-3">類別</th>
                                            <th className="p-3">項目</th>
                                            <th className="p-3">報告設定值</th>
                                            <th className="p-3 text-slate-500 font-normal">備註說明</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-100 bg-white">
                                        {assumptions.map((row, idx) => (
                                            <tr key={idx}>
                                                <td className="p-3 font-bold text-slate-600">{row.category}</td>
                                                <td className="p-3 text-slate-800">{row.item}</td>
                                                <td className="p-3 font-mono text-blue-700 font-bold">{row.value}</td>
                                                <td className="p-3 text-xs text-slate-400">{row.note}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div className="bg-green-50 border-2 border-green-200 rounded-xl p-6 shadow-sm flex flex-col h-full">
                                <div className="flex items-center mb-4 text-green-700 border-b border-green-200 pb-2">
                                    <Icon name="thumbs-up" className="w-8 h-8 mr-3 fill-green-600 text-green-700" />
                                    <h3 className="text-xl font-bold">此專案「可行」的條件</h3>
                                </div>
                                <div className="space-y-4 text-slate-700 flex-1">
                                    <div className="flex items-start">
                                        <div className="bg-green-200 text-green-800 text-xs font-bold px-2 py-1 rounded mr-3 shrink-0 mt-0.5">財務面</div>
                                        <div>
                                            <strong className="block text-green-900">自有資金 &gt; 2.85 億元</strong>
                                            <span className="text-sm">且 2026 年底前需備妥 6,000 萬現金支付前期費用。</span>
                                        </div>
                                    </div>
                                    <div className="flex items-start">
                                        <div className="bg-green-200 text-green-800 text-xs font-bold px-2 py-1 rounded mr-3 shrink-0 mt-0.5">工程面</div>
                                        <div>
                                            <strong className="block text-green-900">如期於 2030 Q3 完工</strong>
                                            <span className="text-sm">完美銜接捷運東環段利多，造價控制在 22 萬/坪以內。</span>
                                        </div>
                                    </div>
                                    <div className="flex items-start">
                                        <div className="bg-green-200 text-green-800 text-xs font-bold px-2 py-1 rounded mr-3 shrink-0 mt-0.5">市場面</div>
                                        <div>
                                            <strong className="block text-green-900">租金 &gt; 1,500 元/坪</strong>
                                            <span className="text-sm">完工一年內出租率達 85%，年收租金達 4,000 萬以上。</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-red-50 border-2 border-red-200 rounded-xl p-6 shadow-sm flex flex-col h-full">
                                <div className="flex items-center mb-4 text-red-700 border-b border-red-200 pb-2">
                                    <Icon name="thumbs-down" className="w-8 h-8 mr-3 fill-red-600 text-red-700" />
                                    <h3 className="text-xl font-bold">此專案「有難度」的情況</h3>
                                </div>
                                <div className="space-y-4 text-slate-700 flex-1">
                                    <div className="flex items-start">
                                        <div className="bg-red-200 text-red-800 text-xs font-bold px-2 py-1 rounded mr-3 shrink-0 mt-0.5">財務面</div>
                                        <div>
                                            <strong className="block text-red-900">流動資金不足 2 億元</strong>
                                            <span className="text-sm">在 2028-29 工程高峰期將面臨資金斷鏈，導致爛尾風險。</span>
                                        </div>
                                    </div>
                                    <div className="flex items-start">
                                        <div className="bg-red-200 text-red-800 text-xs font-bold px-2 py-1 rounded mr-3 shrink-0 mt-0.5">成本面</div>
                                        <div>
                                            <strong className="block text-red-900">造價上漲 &gt; 20%</strong>
                                            <span className="text-sm">若總成本突破 7.8 億，自備款需求將暴增至 3.95 億。</span>
                                        </div>
                                    </div>
                                    <div className="flex items-start">
                                        <div className="bg-red-200 text-red-800 text-xs font-bold px-2 py-1 rounded mr-3 shrink-0 mt-0.5">市場面</div>
                                        <div>
                                            <strong className="block text-red-900">空置期 &gt; 2 年</strong>
                                            <span className="text-sm">每年需現金補貼 3,200 萬 (房貸+稅)，嚴重侵蝕業主資本。</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* 7. New Section: Long-term Cash Flow & Break-even */}
                    <section className="mb-8 bg-blue-50/50 p-6 rounded-xl border border-blue-100">
                        <SectionTitle icon="activity" title="長期金流與回本預測表 (Cash Flow Break-even)" />
                        
                        <div className="flex flex-col gap-6">
                            <div className="h-72 w-full bg-white p-2 rounded shadow-sm border border-slate-100">
                                <ChartComponent type="bar" data={chartLongTermConfig.data} options={chartLongTermConfig.options} />
                            </div>

                            <div className="overflow-x-auto border border-slate-200 rounded-lg shadow-sm font-sans text-xs">
                                <table className="w-full text-center whitespace-nowrap">
                                    <thead className="bg-slate-100 text-slate-700 font-bold">
                                        <tr>
                                            <th className="p-2 border-b">年份</th>
                                            <th className="p-2 border-b text-blue-700">收入 (In)</th>
                                            <th className="p-2 border-b text-red-700">支出 (Out)</th>
                                            <th className="p-2 border-b">年度淨流 (Net)</th>
                                            <th className="p-2 border-b bg-slate-200">累計結餘 (Cum)</th>
                                            <th className="p-2 border-b text-left">備註</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-50 bg-white">
                                        {longTermCashFlowData.map((row, idx) => (
                                            <tr key={idx} className={row.cumulative >= 0 ? 'bg-green-50' : idx % 2 === 0 ? 'bg-white' : 'bg-slate-50/30'}>
                                                <td className="p-2 font-bold text-slate-600">{row.year}</td>
                                                <td className="p-2 text-blue-600">{row.income > 0 ? new Intl.NumberFormat('zh-TW').format(row.income) : '-'}</td>
                                                <td className="p-2 text-red-600">{new Intl.NumberFormat('zh-TW').format(row.expense)}</td>
                                                <td className={`p-2 font-bold ${row.net >= 0 ? 'text-green-600' : 'text-red-500'}`}>
                                                    {new Intl.NumberFormat('zh-TW').format(row.net)}
                                                </td>
                                                <td className={`p-2 font-bold border-l border-slate-100 ${row.cumulative >= 0 ? 'text-green-700' : 'text-slate-500'}`}>
                                                    {new Intl.NumberFormat('zh-TW').format(row.cumulative)}
                                                </td>
                                                <td className="p-2 text-left text-slate-400 text-[10px]">{row.note}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                            
                            <div className="text-xs text-slate-500 bg-white p-3 rounded border border-blue-200">
                                <strong>💡 數據解讀：</strong> 
                                專案於 2030 年完工前均為資金流出，累計最大缺口約 6.5 億元 (含銀行融資)。
                                完工後租金收入進帳，資金缺口逐年縮小，預計於 <strong>2037 年</strong> 轉虧為盈 (Cumulative &gt; 0)，
                                此後進入純獲利階段。
                            </div>
                        </div>
                    </section>

                    {/* Footer */}
                    <footer className="mt-8 border-t border-slate-200 pt-4 flex justify-between items-center text-xs text-slate-400 font-sans">
                        <p>內湖文德大樓興建工程專案小組</p>
                        <p>Page 1 of 1 (v10.0 Final Corrected)</p>
                    </footer>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
